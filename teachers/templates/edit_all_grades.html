{% extends 'base.html' %}
{% load static %}


{% block extra_head %}
    <title>تعديل درجات الطالب: {{ student.name }}</title>
  <link rel="stylesheet" href="{% static 'css/formstyle.css' %}">
    <style>


    /* إخفاء العناصر غير الضرورية */
    td label,
    td .helptext {
        display: none;
    }

    /* حقل الإدخال داخل الخلية */
    td input[type="number"] {
        width: 100%;
        height: 100%;
        border: none;
        background-color: #fafafa;
        text-align: center;
        font-size: 13px;
        border-radius: 0;
        box-sizing: border-box;
        transition: all 0.2s ease;
    }

    /* عند التركيز */
    td input[type="number"]:focus {
        background-color: #fff;
        border: 1px solid #007bff;
        outline: none;
    }

    /* صفوف متناوبة */
    tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    tr:hover {
        background-color: #eef6ff;
    }

    /* عرض رسالة الخطأ فقط عند وجودها */
    .errorlist {
        display: block;
        position: absolute;
        bottom: -18px; /* أسفل الخلية */
        left: 50%;
        transform: translateX(-50%);
        font-size: 11px;
        color: #d9534f; /* أحمر ناعم */
        background: #fff;
        border: 1px solid #f5c2c7;
        padding: 2px 4px;
        border-radius: 3px;
        white-space: nowrap;
        z-index: 2;
    }

    /* تمييز الخلية التي فيها خطأ بشكل خفيف */
    td:has(.errorlist) input {
        border: 1px solid #d9534f;
        background-color: #fff6f6;
    }

    </style>
{% endblock extra_head %}
{% block content %}
<h2>تعديل درجات الطالب: {{ student.name }}</h2>

<form method="POST">
    {% csrf_token %}
    {{ formset.management_form }}
    <div class=".table-container">
        <table class="grade-table">
            <thead>
                <tr>
                    <th>المادة</th>
                    {% for month in months %}
                        <th>{{ month.name }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for sub in subjects %}
                <tr>
                    <td>{{ sub.name }}</td>
                    {% for month in months %}
                        <td>
                            {% for form in formset.forms %}
                                {% if form.instance.month.id == month.id and form.instance.grade_fo_subject.id == sub.id %}
                                    {{ form }}
                                {% endif %}
                            {% endfor %}
                        </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div style="margin-top:20px;">
        <button type="submit" class="btn-primary">حفظ</button>
        <a href="{% url 'teacher_login' %}" class="btn-secondary">إلغاء</a>
    </div>
</form>

{% endblock %}
